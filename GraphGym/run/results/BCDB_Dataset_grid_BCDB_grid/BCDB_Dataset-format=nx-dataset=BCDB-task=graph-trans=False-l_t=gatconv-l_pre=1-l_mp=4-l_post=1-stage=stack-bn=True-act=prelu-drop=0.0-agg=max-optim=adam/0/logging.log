Load: 65.65s, Before split: 0.1511s, Split: 0.004065s, After split: 0.568s
GNN(
  (preprocess): Preprocess(
    node_feature: dim_out=2
    Total: dim_out=2
  )
  (pre_mp): GeneralMultiLayer(
    (Layer_0): GeneralLayer(
      (layer): Linear(
        (model): Linear(in_features=2, out_features=180, bias=False)
      )
      (post_layer): Sequential(
        (0): BatchNorm1d(180, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (1): PReLU(num_parameters=1)
      )
    )
  )
  (mp): GNNStackStage(
    (layer0): GeneralLayer(
      (layer): GATConv(
        (model): GATConv(180, 180, heads=1)
      )
      (post_layer): Sequential(
        (0): BatchNorm1d(180, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (1): PReLU(num_parameters=1)
      )
    )
    (layer1): GeneralLayer(
      (layer): GATConv(
        (model): GATConv(180, 180, heads=1)
      )
      (post_layer): Sequential(
        (0): BatchNorm1d(180, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (1): PReLU(num_parameters=1)
      )
    )
    (layer2): GeneralLayer(
      (layer): GATConv(
        (model): GATConv(180, 180, heads=1)
      )
      (post_layer): Sequential(
        (0): BatchNorm1d(180, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (1): PReLU(num_parameters=1)
      )
    )
    (layer3): GeneralLayer(
      (layer): GATConv(
        (model): GATConv(180, 180, heads=1)
      )
      (post_layer): Sequential(
        (0): BatchNorm1d(180, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (1): PReLU(num_parameters=1)
      )
    )
  )
  (post_mp): GNNGraphHead(
    (layer_post_mp): MLP(
      (model): Sequential(
        (0): Linear(
          (model): Linear(in_features=180, out_features=7, bias=True)
        )
      )
    )
  )
)
bn:
  eps: 1e-05
  mom: 0.1
cfg_dest: config.yaml
custom_metrics: []
dataset:
  augment_feature: []
  augment_feature_dims: []
  augment_feature_repr: original
  augment_label: 
  augment_label_dims: 0
  cache_load: False
  cache_save: False
  dir: ./datasets
  edge_dim: 128
  edge_encoder: False
  edge_encoder_bn: True
  edge_encoder_name: Bond
  edge_message_ratio: 0.8
  edge_negative_sampling_ratio: 1.0
  edge_train_mode: all
  encoder: True
  encoder_bn: True
  encoder_dim: 128
  encoder_name: db
  format: nx
  label_column: none
  label_table: none
  location: local
  name: BCDB
  node_encoder: False
  node_encoder_bn: True
  node_encoder_name: Atom
  remove_feature: False
  resample_disjoint: False
  resample_negative: False
  shuffle_split: True
  split: [0.8, 0.1, 0.1]
  split_mode: random
  task: graph
  task_type: classification
  to_undirected: False
  transductive: False
  transform: none
  tu_simple: True
device: cpu
example_arg: example
example_group:
  example_arg: example
gnn:
  act: prelu
  agg: max
  att_final_linear: False
  att_final_linear_bn: False
  att_heads: 1
  batchnorm: True
  clear_feature: True
  dim_inner: 180
  dropout: 0.0
  flow: source_to_target
  head: graph
  keep_edge: 0.5
  l2norm: True
  layer_type: gatconv
  layers_mp: 4
  layers_post_mp: 1
  layers_pre_mp: 1
  msg_direction: single
  normalize_adj: False
  self_msg: concat
  skip_every: 1
  stage_type: stack
gpu_mem: False
mem:
  inplace: False
metric_agg: argmax
metric_best: auto
model:
  edge_decoding: dot
  graph_pooling: add
  loss_fun: cross_entropy
  match_upper: True
  size_average: mean
  thresh: 0.5
  type: gnn
num_threads: 6
num_workers: 0
optim:
  base_lr: 0.01
  lr_decay: 0.1
  max_epoch: 100
  momentum: 0.9
  optimizer: adam
  scheduler: cos
  steps: [30, 60, 90]
  weight_decay: 0.0005
out_dir: results/BCDB_Dataset_grid_BCDB_grid/BCDB_Dataset-format=nx-dataset=BCDB-task=graph-trans=False-l_t=gatconv-l_pre=1-l_mp=4-l_post=1-stage=stack-bn=True-act=prelu-drop=0.0-agg=max-optim=adam
print: both
round: 4
run_dir: results/BCDB_Dataset_grid_BCDB_grid/BCDB_Dataset-format=nx-dataset=BCDB-task=graph-trans=False-l_t=gatconv-l_pre=1-l_mp=4-l_post=1-stage=stack-bn=True-act=prelu-drop=0.0-agg=max-optim=adam/0
seed: 1
share:
  dim_in: 2
  dim_out: 7
  num_splits: 3
tensorboard_agg: True
tensorboard_each_run: False
train:
  auto_resume: False
  batch_size: 32
  ckpt_clean: True
  ckpt_period: 100
  enable_ckpt: True
  epoch_resume: -1
  eval_period: 20
  iter_per_epoch: 32
  mode: standard
  neighbor_sizes: [20, 15, 10, 5]
  node_per_graph: 32
  radius: extend
  sample_node: False
  sampler: full_batch
  skip_train_eval: False
  walk_length: 4
val:
  node_per_graph: 32
  radius: extend
  sample_node: False
  sampler: full_batch
view_emb: False
Num parameters: 134468
Start from epoch 0
train: {'epoch': 0, 'eta': 6602.9926, 'loss': 1.4489, 'lr': 0.01, 'params': 134468, 'time_iter': 0.5015, 'accuracy': 0.5621}
val: {'epoch': 0, 'loss': 1.4254, 'lr': 0, 'params': 134468, 'time_iter': 0.2006, 'accuracy': 0.5377}
test: {'epoch': 0, 'loss': 1.4364, 'lr': 0, 'params': 134468, 'time_iter': 0.1973, 'accuracy': 0.5198}
train: {'epoch': 1, 'eta': 6959.9937, 'loss': 1.2279, 'lr': 0.01, 'params': 134468, 'time_iter': 0.5665, 'accuracy': 0.6043}
train: {'epoch': 2, 'eta': 7017.1755, 'loss': 1.2527, 'lr': 0.01, 'params': 134468, 'time_iter': 0.5638, 'accuracy': 0.5973}
train: {'epoch': 3, 'eta': 6901.3899, 'loss': 1.2185, 'lr': 0.01, 'params': 134468, 'time_iter': 0.5303, 'accuracy': 0.6074}
train: {'epoch': 4, 'eta': 6774.3996, 'loss': 1.2216, 'lr': 0.01, 'params': 134468, 'time_iter': 0.5187, 'accuracy': 0.6027}
train: {'epoch': 5, 'eta': 6605.0317, 'loss': 1.1358, 'lr': 0.0099, 'params': 134468, 'time_iter': 0.4891, 'accuracy': 0.6185}
train: {'epoch': 6, 'eta': 6848.8561, 'loss': 1.1412, 'lr': 0.0099, 'params': 134468, 'time_iter': 0.7061, 'accuracy': 0.6152}
train: {'epoch': 7, 'eta': 6768.9058, 'loss': 1.1145, 'lr': 0.0099, 'params': 134468, 'time_iter': 0.5496, 'accuracy': 0.623}
train: {'epoch': 8, 'eta': 6617.6877, 'loss': 1.1204, 'lr': 0.0098, 'params': 134468, 'time_iter': 0.4955, 'accuracy': 0.6256}
train: {'epoch': 9, 'eta': 6468.7623, 'loss': 1.1179, 'lr': 0.0098, 'params': 134468, 'time_iter': 0.4831, 'accuracy': 0.6105}
train: {'epoch': 10, 'eta': 6417.8848, 'loss': 1.104, 'lr': 0.0098, 'params': 134468, 'time_iter': 0.5599, 'accuracy': 0.6206}
train: {'epoch': 11, 'eta': 6313.8216, 'loss': 1.1078, 'lr': 0.0097, 'params': 134468, 'time_iter': 0.5094, 'accuracy': 0.6279}
train: {'epoch': 12, 'eta': 6208.1272, 'loss': 1.0527, 'lr': 0.0096, 'params': 134468, 'time_iter': 0.5013, 'accuracy': 0.6199}
train: {'epoch': 13, 'eta': 6171.2094, 'loss': 1.0523, 'lr': 0.0096, 'params': 134468, 'time_iter': 0.5787, 'accuracy': 0.6312}
train: {'epoch': 14, 'eta': 6119.5266, 'loss': 1.0322, 'lr': 0.0095, 'params': 134468, 'time_iter': 0.5662, 'accuracy': 0.6303}
train: {'epoch': 15, 'eta': 6018.6508, 'loss': 1.0237, 'lr': 0.0095, 'params': 134468, 'time_iter': 0.4999, 'accuracy': 0.6385}
train: {'epoch': 16, 'eta': 6042.9415, 'loss': 1.0196, 'lr': 0.0094, 'params': 134468, 'time_iter': 0.6865, 'accuracy': 0.6397}
train: {'epoch': 17, 'eta': 6010.2412, 'loss': 1.0152, 'lr': 0.0093, 'params': 134468, 'time_iter': 0.6136, 'accuracy': 0.6303}
train: {'epoch': 18, 'eta': 5962.006, 'loss': 0.9966, 'lr': 0.0092, 'params': 134468, 'time_iter': 0.5953, 'accuracy': 0.6411}
train: {'epoch': 19, 'eta': 5891.093, 'loss': 0.9786, 'lr': 0.0091, 'params': 134468, 'time_iter': 0.5585, 'accuracy': 0.6449}
val: {'epoch': 19, 'loss': 0.991, 'lr': 0, 'params': 134468, 'time_iter': 0.1791, 'accuracy': 0.6509}
test: {'epoch': 19, 'loss': 0.9773, 'lr': 0, 'params': 134468, 'time_iter': 0.1887, 'accuracy': 0.6573}
train: {'epoch': 20, 'eta': 5802.8648, 'loss': 0.9456, 'lr': 0.009, 'params': 134468, 'time_iter': 0.5245, 'accuracy': 0.6598}
train: {'epoch': 21, 'eta': 5743.3998, 'loss': 0.956, 'lr': 0.009, 'params': 134468, 'time_iter': 0.582, 'accuracy': 0.6489}
train: {'epoch': 22, 'eta': 5683.4892, 'loss': 0.9274, 'lr': 0.0089, 'params': 134468, 'time_iter': 0.5845, 'accuracy': 0.6633}
train: {'epoch': 23, 'eta': 5582.5571, 'loss': 0.9362, 'lr': 0.0088, 'params': 134468, 'time_iter': 0.4906, 'accuracy': 0.6593}
train: {'epoch': 24, 'eta': 5514.1854, 'loss': 0.933, 'lr': 0.0086, 'params': 134468, 'time_iter': 0.565, 'accuracy': 0.6621}
train: {'epoch': 25, 'eta': 5449.7446, 'loss': 0.9068, 'lr': 0.0085, 'params': 134468, 'time_iter': 0.5768, 'accuracy': 0.6706}
train: {'epoch': 26, 'eta': 5516.9862, 'loss': 0.8984, 'lr': 0.0084, 'params': 134468, 'time_iter': 0.9455, 'accuracy': 0.6722}
train: {'epoch': 27, 'eta': 5454.8751, 'loss': 0.8922, 'lr': 0.0083, 'params': 134468, 'time_iter': 0.6076, 'accuracy': 0.6765}
train: {'epoch': 28, 'eta': 5395.2031, 'loss': 0.8794, 'lr': 0.0082, 'params': 134468, 'time_iter': 0.6191, 'accuracy': 0.6819}
train: {'epoch': 29, 'eta': 5326.4411, 'loss': 0.8778, 'lr': 0.0081, 'params': 134468, 'time_iter': 0.5946, 'accuracy': 0.6784}
train: {'epoch': 30, 'eta': 5246.2656, 'loss': 0.8929, 'lr': 0.0079, 'params': 134468, 'time_iter': 0.5583, 'accuracy': 0.6616}
train: {'epoch': 31, 'eta': 5161.883, 'loss': 0.8795, 'lr': 0.0078, 'params': 134468, 'time_iter': 0.5421, 'accuracy': 0.6833}
train: {'epoch': 32, 'eta': 5066.9819, 'loss': 0.8625, 'lr': 0.0077, 'params': 134468, 'time_iter': 0.5004, 'accuracy': 0.6873}
train: {'epoch': 33, 'eta': 4984.4331, 'loss': 0.8775, 'lr': 0.0075, 'params': 134468, 'time_iter': 0.5418, 'accuracy': 0.6807}
train: {'epoch': 34, 'eta': 4893.8965, 'loss': 0.8675, 'lr': 0.0074, 'params': 134468, 'time_iter': 0.507, 'accuracy': 0.6904}
train: {'epoch': 35, 'eta': 4817.6558, 'loss': 0.8583, 'lr': 0.0073, 'params': 134468, 'time_iter': 0.5621, 'accuracy': 0.685}
train: {'epoch': 36, 'eta': 4759.0301, 'loss': 0.8582, 'lr': 0.0071, 'params': 134468, 'time_iter': 0.6395, 'accuracy': 0.6859}
train: {'epoch': 37, 'eta': 4680.9272, 'loss': 0.8673, 'lr': 0.007, 'params': 134468, 'time_iter': 0.5562, 'accuracy': 0.68}
train: {'epoch': 38, 'eta': 4614.6075, 'loss': 0.8548, 'lr': 0.0068, 'params': 134468, 'time_iter': 0.6118, 'accuracy': 0.685}
train: {'epoch': 39, 'eta': 4549.6236, 'loss': 0.851, 'lr': 0.0067, 'params': 134468, 'time_iter': 0.6223, 'accuracy': 0.6885}
val: {'epoch': 39, 'loss': 0.8649, 'lr': 0, 'params': 134468, 'time_iter': 0.214, 'accuracy': 0.666}
test: {'epoch': 39, 'loss': 0.9215, 'lr': 0, 'params': 134468, 'time_iter': 0.2162, 'accuracy': 0.6648}
train: {'epoch': 40, 'eta': 4477.0004, 'loss': 0.8513, 'lr': 0.0065, 'params': 134468, 'time_iter': 0.5869, 'accuracy': 0.6855}
train: {'epoch': 41, 'eta': 4393.1118, 'loss': 0.8538, 'lr': 0.0064, 'params': 134468, 'time_iter': 0.5269, 'accuracy': 0.6904}
train: {'epoch': 42, 'eta': 4310.0512, 'loss': 0.8496, 'lr': 0.0062, 'params': 134468, 'time_iter': 0.528, 'accuracy': 0.6932}
train: {'epoch': 43, 'eta': 4232.4193, 'loss': 0.841, 'lr': 0.0061, 'params': 134468, 'time_iter': 0.5566, 'accuracy': 0.6923}
train: {'epoch': 44, 'eta': 4158.3659, 'loss': 0.8164, 'lr': 0.0059, 'params': 134468, 'time_iter': 0.5776, 'accuracy': 0.7001}
train: {'epoch': 45, 'eta': 4058.5746, 'loss': 0.8354, 'lr': 0.0058, 'params': 134468, 'time_iter': 0.4136, 'accuracy': 0.6956}
train: {'epoch': 46, 'eta': 3958.7932, 'loss': 0.8222, 'lr': 0.0056, 'params': 134468, 'time_iter': 0.4009, 'accuracy': 0.6951}
train: {'epoch': 47, 'eta': 3861.4148, 'loss': 0.813, 'lr': 0.0055, 'params': 134468, 'time_iter': 0.4042, 'accuracy': 0.7017}
train: {'epoch': 48, 'eta': 3775.754, 'loss': 0.8223, 'lr': 0.0053, 'params': 134468, 'time_iter': 0.476, 'accuracy': 0.6956}
train: {'epoch': 49, 'eta': 3702.8176, 'loss': 0.8235, 'lr': 0.0052, 'params': 134468, 'time_iter': 0.5649, 'accuracy': 0.697}
train: {'epoch': 50, 'eta': 3608.0842, 'loss': 0.802, 'lr': 0.005, 'params': 134468, 'time_iter': 0.395, 'accuracy': 0.7001}
train: {'epoch': 51, 'eta': 3520.2341, 'loss': 0.7987, 'lr': 0.0048, 'params': 134468, 'time_iter': 0.4378, 'accuracy': 0.7024}
train: {'epoch': 52, 'eta': 3428.616, 'loss': 0.8053, 'lr': 0.0047, 'params': 134468, 'time_iter': 0.3964, 'accuracy': 0.6968}
train: {'epoch': 53, 'eta': 3338.9709, 'loss': 0.8112, 'lr': 0.0045, 'params': 134468, 'time_iter': 0.4011, 'accuracy': 0.7015}
train: {'epoch': 54, 'eta': 3252.3788, 'loss': 0.8079, 'lr': 0.0044, 'params': 134468, 'time_iter': 0.4171, 'accuracy': 0.6984}
train: {'epoch': 55, 'eta': 3166.6007, 'loss': 0.8082, 'lr': 0.0042, 'params': 134468, 'time_iter': 0.4142, 'accuracy': 0.6998}
train: {'epoch': 56, 'eta': 3081.196, 'loss': 0.8052, 'lr': 0.0041, 'params': 134468, 'time_iter': 0.4072, 'accuracy': 0.7015}
train: {'epoch': 57, 'eta': 2998.434, 'loss': 0.7869, 'lr': 0.0039, 'params': 134468, 'time_iter': 0.4234, 'accuracy': 0.7086}
train: {'epoch': 58, 'eta': 2919.4907, 'loss': 0.7857, 'lr': 0.0038, 'params': 134468, 'time_iter': 0.4551, 'accuracy': 0.7076}
train: {'epoch': 59, 'eta': 2837.419, 'loss': 0.7805, 'lr': 0.0036, 'params': 134468, 'time_iter': 0.4129, 'accuracy': 0.7064}
val: {'epoch': 59, 'loss': 0.7835, 'lr': 0, 'params': 134468, 'time_iter': 0.1691, 'accuracy': 0.6925}
test: {'epoch': 59, 'loss': 0.818, 'lr': 0, 'params': 134468, 'time_iter': 0.1501, 'accuracy': 0.693}
train: {'epoch': 60, 'eta': 2755.8269, 'loss': 0.7897, 'lr': 0.0035, 'params': 134468, 'time_iter': 0.408, 'accuracy': 0.7024}
train: {'epoch': 61, 'eta': 2676.7833, 'loss': 0.7932, 'lr': 0.0033, 'params': 134468, 'time_iter': 0.4285, 'accuracy': 0.7069}
train: {'epoch': 62, 'eta': 2597.7502, 'loss': 0.7819, 'lr': 0.0032, 'params': 134468, 'time_iter': 0.4196, 'accuracy': 0.7074}
train: {'epoch': 63, 'eta': 2520.0337, 'loss': 0.7747, 'lr': 0.003, 'params': 134468, 'time_iter': 0.4275, 'accuracy': 0.714}
train: {'epoch': 64, 'eta': 2444.1927, 'loss': 0.7757, 'lr': 0.0029, 'params': 134468, 'time_iter': 0.4448, 'accuracy': 0.7079}
train: {'epoch': 65, 'eta': 2370.8414, 'loss': 0.7706, 'lr': 0.0027, 'params': 134468, 'time_iter': 0.4737, 'accuracy': 0.7126}
train: {'epoch': 66, 'eta': 2294.5764, 'loss': 0.7636, 'lr': 0.0026, 'params': 134468, 'time_iter': 0.4245, 'accuracy': 0.714}
train: {'epoch': 67, 'eta': 2218.8946, 'loss': 0.7704, 'lr': 0.0025, 'params': 134468, 'time_iter': 0.4246, 'accuracy': 0.7121}
train: {'epoch': 68, 'eta': 2152.2701, 'loss': 0.7584, 'lr': 0.0023, 'params': 134468, 'time_iter': 0.5668, 'accuracy': 0.713}
train: {'epoch': 69, 'eta': 2087.7281, 'loss': 0.7578, 'lr': 0.0022, 'params': 134468, 'time_iter': 0.6077, 'accuracy': 0.7166}
train: {'epoch': 70, 'eta': 2015.3708, 'loss': 0.7601, 'lr': 0.0021, 'params': 134468, 'time_iter': 0.4723, 'accuracy': 0.7137}
train: {'epoch': 71, 'eta': 1945.319, 'loss': 0.7503, 'lr': 0.0019, 'params': 134468, 'time_iter': 0.5118, 'accuracy': 0.7211}
train: {'epoch': 72, 'eta': 1882.0923, 'loss': 0.7473, 'lr': 0.0018, 'params': 134468, 'time_iter': 0.6494, 'accuracy': 0.7185}
train: {'epoch': 73, 'eta': 1816.8843, 'loss': 0.7518, 'lr': 0.0017, 'params': 134468, 'time_iter': 0.6204, 'accuracy': 0.7187}
train: {'epoch': 74, 'eta': 1748.125, 'loss': 0.7528, 'lr': 0.0016, 'params': 134468, 'time_iter': 0.5507, 'accuracy': 0.7222}
train: {'epoch': 75, 'eta': 1678.4472, 'loss': 0.7525, 'lr': 0.0015, 'params': 134468, 'time_iter': 0.5316, 'accuracy': 0.718}
train: {'epoch': 76, 'eta': 1612.0757, 'loss': 0.7401, 'lr': 0.0014, 'params': 134468, 'time_iter': 0.6155, 'accuracy': 0.7227}
train: {'epoch': 77, 'eta': 1545.1207, 'loss': 0.7434, 'lr': 0.0012, 'params': 134468, 'time_iter': 0.6106, 'accuracy': 0.7178}
train: {'epoch': 78, 'eta': 1478.2786, 'loss': 0.7357, 'lr': 0.0011, 'params': 134468, 'time_iter': 0.624, 'accuracy': 0.7147}
train: {'epoch': 79, 'eta': 1412.5264, 'loss': 0.7492, 'lr': 0.001, 'params': 134468, 'time_iter': 0.6689, 'accuracy': 0.7203}
val: {'epoch': 79, 'loss': 0.7529, 'lr': 0, 'params': 134468, 'time_iter': 0.1765, 'accuracy': 0.7075}
test: {'epoch': 79, 'loss': 0.8029, 'lr': 0, 'params': 134468, 'time_iter': 0.1653, 'accuracy': 0.7175}
train: {'epoch': 80, 'eta': 1346.0761, 'loss': 0.744, 'lr': 0.001, 'params': 134468, 'time_iter': 0.6649, 'accuracy': 0.7194}
train: {'epoch': 81, 'eta': 1277.4147, 'loss': 0.7406, 'lr': 0.0009, 'params': 134468, 'time_iter': 0.6075, 'accuracy': 0.717}
train: {'epoch': 82, 'eta': 1209.2997, 'loss': 0.7364, 'lr': 0.0008, 'params': 134468, 'time_iter': 0.6383, 'accuracy': 0.7255}
train: {'epoch': 83, 'eta': 1146.4317, 'loss': 0.7432, 'lr': 0.0007, 'params': 134468, 'time_iter': 0.8612, 'accuracy': 0.7175}
train: {'epoch': 84, 'eta': 1083.3346, 'loss': 0.7388, 'lr': 0.0006, 'params': 134468, 'time_iter': 0.9032, 'accuracy': 0.7232}
train: {'epoch': 85, 'eta': 1020.1404, 'loss': 0.733, 'lr': 0.0005, 'params': 134468, 'time_iter': 0.96, 'accuracy': 0.7211}
train: {'epoch': 86, 'eta': 953.3571, 'loss': 0.7375, 'lr': 0.0005, 'params': 134468, 'time_iter': 0.854, 'accuracy': 0.7199}
train: {'epoch': 87, 'eta': 893.047, 'loss': 0.7338, 'lr': 0.0004, 'params': 134468, 'time_iter': 1.2696, 'accuracy': 0.7222}
