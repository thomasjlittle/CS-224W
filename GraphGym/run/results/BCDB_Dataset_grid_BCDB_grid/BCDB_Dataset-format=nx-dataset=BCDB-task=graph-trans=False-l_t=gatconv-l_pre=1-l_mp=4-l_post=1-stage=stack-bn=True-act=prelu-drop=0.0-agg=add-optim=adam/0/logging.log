Load: 57.03s, Before split: 0.1349s, Split: 0.08973s, After split: 0.8731s
GNN(
  (preprocess): Preprocess(
    node_feature: dim_out=2
    Total: dim_out=2
  )
  (pre_mp): GeneralMultiLayer(
    (Layer_0): GeneralLayer(
      (layer): Linear(
        (model): Linear(in_features=2, out_features=180, bias=False)
      )
      (post_layer): Sequential(
        (0): BatchNorm1d(180, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (1): PReLU(num_parameters=1)
      )
    )
  )
  (mp): GNNStackStage(
    (layer0): GeneralLayer(
      (layer): GATConv(
        (model): GATConv(180, 180, heads=1)
      )
      (post_layer): Sequential(
        (0): BatchNorm1d(180, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (1): PReLU(num_parameters=1)
      )
    )
    (layer1): GeneralLayer(
      (layer): GATConv(
        (model): GATConv(180, 180, heads=1)
      )
      (post_layer): Sequential(
        (0): BatchNorm1d(180, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (1): PReLU(num_parameters=1)
      )
    )
    (layer2): GeneralLayer(
      (layer): GATConv(
        (model): GATConv(180, 180, heads=1)
      )
      (post_layer): Sequential(
        (0): BatchNorm1d(180, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (1): PReLU(num_parameters=1)
      )
    )
    (layer3): GeneralLayer(
      (layer): GATConv(
        (model): GATConv(180, 180, heads=1)
      )
      (post_layer): Sequential(
        (0): BatchNorm1d(180, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (1): PReLU(num_parameters=1)
      )
    )
  )
  (post_mp): GNNGraphHead(
    (layer_post_mp): MLP(
      (model): Sequential(
        (0): Linear(
          (model): Linear(in_features=180, out_features=7, bias=True)
        )
      )
    )
  )
)
bn:
  eps: 1e-05
  mom: 0.1
cfg_dest: config.yaml
custom_metrics: []
dataset:
  augment_feature: []
  augment_feature_dims: []
  augment_feature_repr: original
  augment_label: 
  augment_label_dims: 0
  cache_load: False
  cache_save: False
  dir: ./datasets
  edge_dim: 128
  edge_encoder: False
  edge_encoder_bn: True
  edge_encoder_name: Bond
  edge_message_ratio: 0.8
  edge_negative_sampling_ratio: 1.0
  edge_train_mode: all
  encoder: True
  encoder_bn: True
  encoder_dim: 128
  encoder_name: db
  format: nx
  label_column: none
  label_table: none
  location: local
  name: BCDB
  node_encoder: False
  node_encoder_bn: True
  node_encoder_name: Atom
  remove_feature: False
  resample_disjoint: False
  resample_negative: False
  shuffle_split: True
  split: [0.8, 0.1, 0.1]
  split_mode: random
  task: graph
  task_type: classification
  to_undirected: False
  transductive: False
  transform: none
  tu_simple: True
device: cpu
example_arg: example
example_group:
  example_arg: example
gnn:
  act: prelu
  agg: add
  att_final_linear: False
  att_final_linear_bn: False
  att_heads: 1
  batchnorm: True
  clear_feature: True
  dim_inner: 180
  dropout: 0.0
  flow: source_to_target
  head: graph
  keep_edge: 0.5
  l2norm: True
  layer_type: gatconv
  layers_mp: 4
  layers_post_mp: 1
  layers_pre_mp: 1
  msg_direction: single
  normalize_adj: False
  self_msg: concat
  skip_every: 1
  stage_type: stack
gpu_mem: False
mem:
  inplace: False
metric_agg: argmax
metric_best: auto
model:
  edge_decoding: dot
  graph_pooling: add
  loss_fun: cross_entropy
  match_upper: True
  size_average: mean
  thresh: 0.5
  type: gnn
num_threads: 6
num_workers: 0
optim:
  base_lr: 0.01
  lr_decay: 0.1
  max_epoch: 100
  momentum: 0.9
  optimizer: adam
  scheduler: cos
  steps: [30, 60, 90]
  weight_decay: 0.0005
out_dir: results/BCDB_Dataset_grid_BCDB_grid/BCDB_Dataset-format=nx-dataset=BCDB-task=graph-trans=False-l_t=gatconv-l_pre=1-l_mp=4-l_post=1-stage=stack-bn=True-act=prelu-drop=0.0-agg=add-optim=adam
print: both
round: 4
run_dir: results/BCDB_Dataset_grid_BCDB_grid/BCDB_Dataset-format=nx-dataset=BCDB-task=graph-trans=False-l_t=gatconv-l_pre=1-l_mp=4-l_post=1-stage=stack-bn=True-act=prelu-drop=0.0-agg=add-optim=adam/0
seed: 1
share:
  dim_in: 2
  dim_out: 7
  num_splits: 3
tensorboard_agg: True
tensorboard_each_run: False
train:
  auto_resume: False
  batch_size: 32
  ckpt_clean: True
  ckpt_period: 100
  enable_ckpt: True
  epoch_resume: -1
  eval_period: 20
  iter_per_epoch: 32
  mode: standard
  neighbor_sizes: [20, 15, 10, 5]
  node_per_graph: 32
  radius: extend
  sample_node: False
  sampler: full_batch
  skip_train_eval: False
  walk_length: 4
val:
  node_per_graph: 32
  radius: extend
  sample_node: False
  sampler: full_batch
view_emb: False
Num parameters: 134468
Start from epoch 0
train: {'epoch': 0, 'eta': 6803.5102, 'loss': 1.4489, 'lr': 0.01, 'params': 134468, 'time_iter': 0.5167, 'accuracy': 0.5621}
val: {'epoch': 0, 'loss': 1.4254, 'lr': 0, 'params': 134468, 'time_iter': 0.159, 'accuracy': 0.5377}
test: {'epoch': 0, 'loss': 1.4364, 'lr': 0, 'params': 134468, 'time_iter': 0.1799, 'accuracy': 0.5198}
train: {'epoch': 1, 'eta': 6683.5689, 'loss': 1.2279, 'lr': 0.01, 'params': 134468, 'time_iter': 0.5088, 'accuracy': 0.6043}
train: {'epoch': 2, 'eta': 6536.7652, 'loss': 1.2527, 'lr': 0.01, 'params': 134468, 'time_iter': 0.4945, 'accuracy': 0.5973}
train: {'epoch': 3, 'eta': 6443.172, 'loss': 1.2185, 'lr': 0.01, 'params': 134468, 'time_iter': 0.4985, 'accuracy': 0.6074}
train: {'epoch': 4, 'eta': 6193.7895, 'loss': 1.2216, 'lr': 0.01, 'params': 134468, 'time_iter': 0.4325, 'accuracy': 0.6027}
train: {'epoch': 5, 'eta': 6009.7685, 'loss': 1.1358, 'lr': 0.0099, 'params': 134468, 'time_iter': 0.4332, 'accuracy': 0.6185}
train: {'epoch': 6, 'eta': 5852.0331, 'loss': 1.1412, 'lr': 0.0099, 'params': 134468, 'time_iter': 0.4276, 'accuracy': 0.6152}
train: {'epoch': 7, 'eta': 5990.7123, 'loss': 1.1145, 'lr': 0.0099, 'params': 134468, 'time_iter': 0.6049, 'accuracy': 0.623}
train: {'epoch': 8, 'eta': 5865.2899, 'loss': 1.1204, 'lr': 0.0098, 'params': 134468, 'time_iter': 0.4448, 'accuracy': 0.6256}
train: {'epoch': 9, 'eta': 5781.197, 'loss': 1.1179, 'lr': 0.0098, 'params': 134468, 'time_iter': 0.4682, 'accuracy': 0.6105}
train: {'epoch': 10, 'eta': 5650.127, 'loss': 1.104, 'lr': 0.0098, 'params': 134468, 'time_iter': 0.4209, 'accuracy': 0.6206}
train: {'epoch': 11, 'eta': 5546.5928, 'loss': 1.1078, 'lr': 0.0097, 'params': 134468, 'time_iter': 0.4363, 'accuracy': 0.6279}
train: {'epoch': 12, 'eta': 5480.3673, 'loss': 1.0527, 'lr': 0.0096, 'params': 134468, 'time_iter': 0.4703, 'accuracy': 0.6199}
train: {'epoch': 13, 'eta': 5392.3103, 'loss': 1.0523, 'lr': 0.0096, 'params': 134468, 'time_iter': 0.443, 'accuracy': 0.6312}
train: {'epoch': 14, 'eta': 5291.7001, 'loss': 1.0322, 'lr': 0.0095, 'params': 134468, 'time_iter': 0.4211, 'accuracy': 0.6303}
train: {'epoch': 15, 'eta': 5233.9133, 'loss': 1.0237, 'lr': 0.0095, 'params': 134468, 'time_iter': 0.4745, 'accuracy': 0.6385}
train: {'epoch': 16, 'eta': 5194.447, 'loss': 1.0196, 'lr': 0.0094, 'params': 134468, 'time_iter': 0.5037, 'accuracy': 0.6397}
train: {'epoch': 17, 'eta': 5118.4933, 'loss': 1.0152, 'lr': 0.0093, 'params': 134468, 'time_iter': 0.4485, 'accuracy': 0.6303}
train: {'epoch': 18, 'eta': 5082.9055, 'loss': 0.9966, 'lr': 0.0092, 'params': 134468, 'time_iter': 0.5167, 'accuracy': 0.6411}
train: {'epoch': 19, 'eta': 5007.0864, 'loss': 0.9786, 'lr': 0.0091, 'params': 134468, 'time_iter': 0.4473, 'accuracy': 0.6449}
val: {'epoch': 19, 'loss': 0.991, 'lr': 0, 'params': 134468, 'time_iter': 0.1565, 'accuracy': 0.6509}
test: {'epoch': 19, 'loss': 0.9773, 'lr': 0, 'params': 134468, 'time_iter': 0.1654, 'accuracy': 0.6573}
train: {'epoch': 20, 'eta': 4930.4932, 'loss': 0.9456, 'lr': 0.009, 'params': 134468, 'time_iter': 0.4426, 'accuracy': 0.6598}
train: {'epoch': 21, 'eta': 4857.5607, 'loss': 0.956, 'lr': 0.009, 'params': 134468, 'time_iter': 0.4469, 'accuracy': 0.6489}
train: {'epoch': 22, 'eta': 4776.2156, 'loss': 0.9274, 'lr': 0.0089, 'params': 134468, 'time_iter': 0.4254, 'accuracy': 0.6633}
train: {'epoch': 23, 'eta': 4714.9578, 'loss': 0.9362, 'lr': 0.0088, 'params': 134468, 'time_iter': 0.4682, 'accuracy': 0.6593}
train: {'epoch': 24, 'eta': 4641.3742, 'loss': 0.933, 'lr': 0.0086, 'params': 134468, 'time_iter': 0.4375, 'accuracy': 0.6621}
train: {'epoch': 25, 'eta': 4565.7017, 'loss': 0.9068, 'lr': 0.0085, 'params': 134468, 'time_iter': 0.4289, 'accuracy': 0.6706}
train: {'epoch': 26, 'eta': 4528.8423, 'loss': 0.8984, 'lr': 0.0084, 'params': 134468, 'time_iter': 0.533, 'accuracy': 0.6722}
train: {'epoch': 27, 'eta': 4452.9594, 'loss': 0.8922, 'lr': 0.0083, 'params': 134468, 'time_iter': 0.426, 'accuracy': 0.6765}
train: {'epoch': 28, 'eta': 4397.0162, 'loss': 0.8794, 'lr': 0.0082, 'params': 134468, 'time_iter': 0.4831, 'accuracy': 0.6819}
train: {'epoch': 29, 'eta': 4324.6307, 'loss': 0.8778, 'lr': 0.0081, 'params': 134468, 'time_iter': 0.4319, 'accuracy': 0.6784}
train: {'epoch': 30, 'eta': 4253.6323, 'loss': 0.8929, 'lr': 0.0079, 'params': 134468, 'time_iter': 0.4334, 'accuracy': 0.6616}
train: {'epoch': 31, 'eta': 4213.4474, 'loss': 0.8795, 'lr': 0.0078, 'params': 134468, 'time_iter': 0.5394, 'accuracy': 0.6833}
train: {'epoch': 32, 'eta': 4195.581, 'loss': 0.8625, 'lr': 0.0077, 'params': 134468, 'time_iter': 0.6292, 'accuracy': 0.6873}
train: {'epoch': 33, 'eta': 4131.4349, 'loss': 0.8775, 'lr': 0.0075, 'params': 134468, 'time_iter': 0.4649, 'accuracy': 0.6807}
train: {'epoch': 34, 'eta': 4069.8183, 'loss': 0.8675, 'lr': 0.0074, 'params': 134468, 'time_iter': 0.4746, 'accuracy': 0.6904}
train: {'epoch': 35, 'eta': 4007.7123, 'loss': 0.8583, 'lr': 0.0073, 'params': 134468, 'time_iter': 0.4729, 'accuracy': 0.685}
train: {'epoch': 36, 'eta': 3949.1724, 'loss': 0.8582, 'lr': 0.0071, 'params': 134468, 'time_iter': 0.4888, 'accuracy': 0.6859}
train: {'epoch': 37, 'eta': 3878.9709, 'loss': 0.8673, 'lr': 0.007, 'params': 134468, 'time_iter': 0.4367, 'accuracy': 0.68}
train: {'epoch': 38, 'eta': 3815.3814, 'loss': 0.8548, 'lr': 0.0068, 'params': 134468, 'time_iter': 0.4655, 'accuracy': 0.685}
train: {'epoch': 39, 'eta': 3747.1241, 'loss': 0.851, 'lr': 0.0067, 'params': 134468, 'time_iter': 0.4417, 'accuracy': 0.6885}
val: {'epoch': 39, 'loss': 0.8649, 'lr': 0, 'params': 134468, 'time_iter': 0.1814, 'accuracy': 0.666}
test: {'epoch': 39, 'loss': 0.9215, 'lr': 0, 'params': 134468, 'time_iter': 0.165, 'accuracy': 0.6648}
train: {'epoch': 40, 'eta': 3684.7992, 'loss': 0.8513, 'lr': 0.0065, 'params': 134468, 'time_iter': 0.4702, 'accuracy': 0.6855}
train: {'epoch': 41, 'eta': 3624.7909, 'loss': 0.8538, 'lr': 0.0064, 'params': 134468, 'time_iter': 0.4829, 'accuracy': 0.6904}
train: {'epoch': 42, 'eta': 3570.0671, 'loss': 0.8496, 'lr': 0.0062, 'params': 134468, 'time_iter': 0.514, 'accuracy': 0.6932}
train: {'epoch': 43, 'eta': 3519.127, 'loss': 0.841, 'lr': 0.0061, 'params': 134468, 'time_iter': 0.54, 'accuracy': 0.6923}
train: {'epoch': 44, 'eta': 3470.4676, 'loss': 0.8164, 'lr': 0.0059, 'params': 134468, 'time_iter': 0.5597, 'accuracy': 0.7001}
train: {'epoch': 45, 'eta': 3409.4435, 'loss': 0.8354, 'lr': 0.0058, 'params': 134468, 'time_iter': 0.4877, 'accuracy': 0.6956}
train: {'epoch': 46, 'eta': 3359.5068, 'loss': 0.8222, 'lr': 0.0056, 'params': 134468, 'time_iter': 0.5627, 'accuracy': 0.6951}
train: {'epoch': 47, 'eta': 3303.0598, 'loss': 0.813, 'lr': 0.0055, 'params': 134468, 'time_iter': 0.5248, 'accuracy': 0.7017}
train: {'epoch': 48, 'eta': 3242.6134, 'loss': 0.8223, 'lr': 0.0053, 'params': 134468, 'time_iter': 0.4998, 'accuracy': 0.6956}
train: {'epoch': 49, 'eta': 3176.5425, 'loss': 0.8235, 'lr': 0.0052, 'params': 134468, 'time_iter': 0.4593, 'accuracy': 0.697}
train: {'epoch': 50, 'eta': 3112.077, 'loss': 0.802, 'lr': 0.005, 'params': 134468, 'time_iter': 0.4704, 'accuracy': 0.7001}
train: {'epoch': 51, 'eta': 3055.0732, 'loss': 0.7987, 'lr': 0.0048, 'params': 134468, 'time_iter': 0.5305, 'accuracy': 0.7024}
train: {'epoch': 52, 'eta': 2996.5918, 'loss': 0.8053, 'lr': 0.0047, 'params': 134468, 'time_iter': 0.5224, 'accuracy': 0.6968}
train: {'epoch': 53, 'eta': 2933.4265, 'loss': 0.8112, 'lr': 0.0045, 'params': 134468, 'time_iter': 0.4846, 'accuracy': 0.7015}
train: {'epoch': 54, 'eta': 2860.8255, 'loss': 0.8079, 'lr': 0.0044, 'params': 134468, 'time_iter': 0.3983, 'accuracy': 0.6984}
train: {'epoch': 55, 'eta': 2788.8344, 'loss': 0.8082, 'lr': 0.0042, 'params': 134468, 'time_iter': 0.3975, 'accuracy': 0.6998}
train: {'epoch': 56, 'eta': 2724.1313, 'loss': 0.8052, 'lr': 0.0041, 'params': 134468, 'time_iter': 0.4634, 'accuracy': 0.7015}
train: {'epoch': 57, 'eta': 2664.9264, 'loss': 0.7869, 'lr': 0.0039, 'params': 134468, 'time_iter': 0.5194, 'accuracy': 0.7086}
train: {'epoch': 58, 'eta': 2593.9349, 'loss': 0.7857, 'lr': 0.0038, 'params': 134468, 'time_iter': 0.3955, 'accuracy': 0.7076}
train: {'epoch': 59, 'eta': 2524.5531, 'loss': 0.7805, 'lr': 0.0036, 'params': 134468, 'time_iter': 0.4067, 'accuracy': 0.7064}
val: {'epoch': 59, 'loss': 0.7835, 'lr': 0, 'params': 134468, 'time_iter': 0.1942, 'accuracy': 0.6925}
test: {'epoch': 59, 'loss': 0.818, 'lr': 0, 'params': 134468, 'time_iter': 0.1667, 'accuracy': 0.693}
train: {'epoch': 60, 'eta': 2456.4015, 'loss': 0.7897, 'lr': 0.0035, 'params': 134468, 'time_iter': 0.4153, 'accuracy': 0.7024}
train: {'epoch': 61, 'eta': 2387.8427, 'loss': 0.7932, 'lr': 0.0033, 'params': 134468, 'time_iter': 0.4052, 'accuracy': 0.7069}
train: {'epoch': 62, 'eta': 2320.1795, 'loss': 0.7819, 'lr': 0.0032, 'params': 134468, 'time_iter': 0.4107, 'accuracy': 0.7074}
train: {'epoch': 63, 'eta': 2253.4838, 'loss': 0.7747, 'lr': 0.003, 'params': 134468, 'time_iter': 0.4182, 'accuracy': 0.714}
train: {'epoch': 64, 'eta': 2187.0294, 'loss': 0.7757, 'lr': 0.0029, 'params': 134468, 'time_iter': 0.4168, 'accuracy': 0.7079}
train: {'epoch': 65, 'eta': 2121.3546, 'loss': 0.7706, 'lr': 0.0027, 'params': 134468, 'time_iter': 0.4233, 'accuracy': 0.7126}
train: {'epoch': 66, 'eta': 2058.6511, 'loss': 0.7636, 'lr': 0.0026, 'params': 134468, 'time_iter': 0.4644, 'accuracy': 0.714}
train: {'epoch': 67, 'eta': 1994.1041, 'loss': 0.7704, 'lr': 0.0025, 'params': 134468, 'time_iter': 0.4345, 'accuracy': 0.7121}
train: {'epoch': 68, 'eta': 1929.8416, 'loss': 0.7584, 'lr': 0.0023, 'params': 134468, 'time_iter': 0.436, 'accuracy': 0.713}
train: {'epoch': 69, 'eta': 1866.5889, 'loss': 0.7578, 'lr': 0.0022, 'params': 134468, 'time_iter': 0.4505, 'accuracy': 0.7166}
train: {'epoch': 70, 'eta': 1804.6796, 'loss': 0.7601, 'lr': 0.0021, 'params': 134468, 'time_iter': 0.4735, 'accuracy': 0.7137}
train: {'epoch': 71, 'eta': 1742.1168, 'loss': 0.7503, 'lr': 0.0019, 'params': 134468, 'time_iter': 0.4615, 'accuracy': 0.7211}
train: {'epoch': 72, 'eta': 1680.1053, 'loss': 0.7473, 'lr': 0.0018, 'params': 134468, 'time_iter': 0.472, 'accuracy': 0.7185}
train: {'epoch': 73, 'eta': 1620.3649, 'loss': 0.7518, 'lr': 0.0017, 'params': 134468, 'time_iter': 0.5211, 'accuracy': 0.7187}
train: {'epoch': 74, 'eta': 1558.4919, 'loss': 0.7528, 'lr': 0.0016, 'params': 134468, 'time_iter': 0.4787, 'accuracy': 0.7222}
train: {'epoch': 75, 'eta': 1498.4448, 'loss': 0.7525, 'lr': 0.0015, 'params': 134468, 'time_iter': 0.5233, 'accuracy': 0.718}
train: {'epoch': 76, 'eta': 1443.0378, 'loss': 0.7401, 'lr': 0.0014, 'params': 134468, 'time_iter': 0.6463, 'accuracy': 0.7227}
train: {'epoch': 77, 'eta': 1386.0044, 'loss': 0.7434, 'lr': 0.0012, 'params': 134468, 'time_iter': 0.6239, 'accuracy': 0.7178}
train: {'epoch': 78, 'eta': 1327.8557, 'loss': 0.7357, 'lr': 0.0011, 'params': 134468, 'time_iter': 0.6109, 'accuracy': 0.7147}
train: {'epoch': 79, 'eta': 1276.7717, 'loss': 0.7492, 'lr': 0.001, 'params': 134468, 'time_iter': 0.8408, 'accuracy': 0.7203}
val: {'epoch': 79, 'loss': 0.7529, 'lr': 0, 'params': 134468, 'time_iter': 0.2568, 'accuracy': 0.7075}
test: {'epoch': 79, 'loss': 0.8029, 'lr': 0, 'params': 134468, 'time_iter': 0.219, 'accuracy': 0.7175}
train: {'epoch': 80, 'eta': 1226.1582, 'loss': 0.744, 'lr': 0.001, 'params': 134468, 'time_iter': 0.9039, 'accuracy': 0.7194}
train: {'epoch': 81, 'eta': 1170.8589, 'loss': 0.7406, 'lr': 0.0009, 'params': 134468, 'time_iter': 0.8016, 'accuracy': 0.717}
train: {'epoch': 82, 'eta': 1116.9507, 'loss': 0.7364, 'lr': 0.0008, 'params': 134468, 'time_iter': 0.898, 'accuracy': 0.7255}
train: {'epoch': 83, 'eta': 1060.9454, 'loss': 0.7432, 'lr': 0.0007, 'params': 134468, 'time_iter': 0.8768, 'accuracy': 0.7175}
train: {'epoch': 84, 'eta': 1004.381, 'loss': 0.7388, 'lr': 0.0006, 'params': 134468, 'time_iter': 0.9138, 'accuracy': 0.7232}
train: {'epoch': 85, 'eta': 946.6663, 'loss': 0.733, 'lr': 0.0005, 'params': 134468, 'time_iter': 0.9304, 'accuracy': 0.7211}
train: {'epoch': 86, 'eta': 889.1129, 'loss': 0.7375, 'lr': 0.0005, 'params': 134468, 'time_iter': 1.0149, 'accuracy': 0.7199}
train: {'epoch': 87, 'eta': 832.792, 'loss': 0.7338, 'lr': 0.0004, 'params': 134468, 'time_iter': 1.1799, 'accuracy': 0.7222}
train: {'epoch': 88, 'eta': 775.8888, 'loss': 0.7308, 'lr': 0.0004, 'params': 134468, 'time_iter': 1.282, 'accuracy': 0.7206}
train: {'epoch': 89, 'eta': 717.2377, 'loss': 0.7241, 'lr': 0.0003, 'params': 134468, 'time_iter': 1.3345, 'accuracy': 0.7192}
train: {'epoch': 90, 'eta': 655.5919, 'loss': 0.7277, 'lr': 0.0002, 'params': 134468, 'time_iter': 1.3054, 'accuracy': 0.7255}
